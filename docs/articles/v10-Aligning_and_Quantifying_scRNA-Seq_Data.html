<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aligning and Quantifying scRNA-Seq Data • singleCellTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Aligning and Quantifying scRNA-Seq Data">
<meta property="og:description" content="singleCellTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/v01-Introduction_to_singleCellTK.html">Introduction to singleCellTK</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Interactive Shiny Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v03-tab01_Upload.html">1: Upload</a>
    </li>
    <li>
      <a href="../articles/v04-tab02_QC-and-Filtering.html">2: Data Summary and Filtering</a>
    </li>
    <li>
      <a href="../articles/v06-tab04_Batch-Correction.html">3: Batch Correction</a>
    </li>
    <li>
      <a href="../articles/v05-tab03_Visualization-and-Clustering.html">4: Visualization and Clustering</a>
    </li>
    <li>
      <a href="../articles/v07-tab05_Differential-Expression.html">5: Differential Expression</a>
    </li>
    <li>
      <a href="../articles/v08-tab06_Pathway-Activity-Analysis.html">6: Pathway Activity Analysis</a>
    </li>
    <li>
      <a href="../articles/v09-tab07_Sample-Size.html">7: Sample Size</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Command Line Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v02-Processing_and_Visualizing_Data_in_the_SingleCellTK.html">Processing and Visualizing Data</a>
    </li>
    <li>
      <a href="../articles/v10-Aligning_and_Quantifying_scRNA-Seq_Data.html">Aligning and Quantifying scRNA-Seq Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wevanjohnson/singleCellTK" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Aligning and Quantifying scRNA-Seq Data</h1>
                        <h4 data-toc-skip class="author">David Jenkins</h4>
            <address class="author_afil">
      The Section of Computational Biomedicine, Boston University School of Medicine, Boston, MAProgram in Bioinformatics, Boston University, Boston, MA<br><a class="author_email" href="mailto:#"></a><a href="mailto:dfj@bu.edu" class="email">dfj@bu.edu</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/wevanjohnson/singleCellTK/blob/HEAD/vignettes/v10-Aligning_and_Quantifying_scRNA-Seq_Data.Rmd" class="external-link"><code>vignettes/v10-Aligning_and_Quantifying_scRNA-Seq_Data.Rmd</code></a></small>
      <div class="hidden name"><code>v10-Aligning_and_Quantifying_scRNA-Seq_Data.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we will suggest a workflow for processing single cell RNA-Seq data to produce an SCtkExperiment object that can be used in the single cell toolkit.</p>
<div class="section level2">
<h2 id="suggested-software">Suggested Software<a class="anchor" aria-label="anchor" href="#suggested-software"></a>
</h2>
<p>Some of the steps in this workflow are performed outside of R and are optional, but they produce useful metrics that can be explored using the single cell toolkit. Please see the individual tool websites for installation instructions.</p>
<ul>
<li>
<a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/" class="external-link">FastQC</a> - Command line or GUI program for performing quality control on sequencing files</li>
<li>
<a href="http://multiqc.info/" class="external-link">MultiQC</a> - Command line tool that creates a combined report from FastQC results run on individual files.</li>
<li>
<a href="https://www.bioconductor.org/packages/release/bioc/html/Rsubread.html" class="external-link">Rsubread</a> - R package for alignment of fastq files to a reference genome</li>
</ul>
</div>
<div class="section level2">
<h2 id="tutorial-single-cell-rna-seq-reads-to-single-cell-object">Tutorial, Single Cell RNA-Seq Reads to Single Cell Object<a class="anchor" aria-label="anchor" href="#tutorial-single-cell-rna-seq-reads-to-single-cell-object"></a>
</h2>
<div class="section level3">
<h3 id="step-1-fastqc-quality-control">Step 1: FastQC Quality Control<a class="anchor" aria-label="anchor" href="#step-1-fastqc-quality-control"></a>
</h3>
<p>Quality control performed on the FASTQ files can identify low quality or failed samples that you may want to exclude from downstream analysis. FastQC is the standard tool used for quality control of fastq files. Run FastQC on the command line on each individual file:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> input_read_1.fastq.gz</span></code></pre></div>
<p>This command will create a fastqc HTML report and a zip file of fastqc result files. To combine individual sample reports into a single report, use multiqc:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">multiqc</span> .</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-gather-sample-annotations-and-feature-annotations">Step 2: Gather sample annotations and feature annotations<a class="anchor" aria-label="anchor" href="#step-2-gather-sample-annotations-and-feature-annotations"></a>
</h3>
<p>The single cell object contains raw read counts, normalized expression data, sample annotations, and feature annotations along with downstream analysis. While you can make a single cell object with just a count matrix, to take advantage of some of the analyses available in the single cell toolkit, sample annotation information and feature information may be helpful.</p>
<div class="section level4">
<h4 id="sample-annotation-data-frame">Sample Annotation Data Frame<a class="anchor" aria-label="anchor" href="#sample-annotation-data-frame"></a>
</h4>
<p>The sample annotation data frame should contain columns of annotation information and row names that match the sample names in the count matrix. The output table <code>multiqc_fastqc.txt</code> can be used as a sample annotation data frame.</p>
</div>
<div class="section level4">
<h4 id="feature-annotation-data-frame">Feature Annotation Data Frame<a class="anchor" aria-label="anchor" href="#feature-annotation-data-frame"></a>
</h4>
<p>The feature annotation data frame should contain columns of annotation information and row names that match the row names in the count matrix.</p>
</div>
</div>
<div class="section level3">
<h3 id="step-3-align-the-data-with-alignsinglecelldata">Step 3: Align the data with alignSingleCellData()<a class="anchor" aria-label="anchor" href="#step-3-align-the-data-with-alignsinglecelldata"></a>
</h3>
<p>For basic alignment and feature counting you can use the <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function in the single cell toolkit to align fastq data to a reference genome, count the number of reads per gene, and create a single cell object that contains annotation information. After running the <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function you can take the single cell object directly into the shiny app for downstream analysis. Detailed information about the options available in the <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function can be found in the function help, but here is an example command:</p>
<blockquote>
<p><strong>NOTE</strong>: Alignment to large genomes (the human genome) can take more than 8GB of memory. Make sure to run the <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function from a computer with sufficient memory.</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">singlecellobject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alignSingleCellData.html">alignSingleCellData</a></span><span class="op">(</span>inputfile1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"/path/to/sample1_1.fastq.gz"</span>,<span class="st">"/path/to/sample2_1.fastq.gz"</span><span class="op">)</span>,
  inputfile2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"/path/to/sample1_2.fastq.gz"</span>,
                 <span class="st">"/path/to/sample2_2.fastq.gz"</span><span class="op">)</span>,
  indexPath <span class="op">=</span> <span class="st">"/path/to/genome/index"</span>,
  gtfAnnotation <span class="op">=</span> <span class="st">"/path/to/gene/annotations.gtf"</span>,
  sampleAnnotations <span class="op">=</span> <span class="va">sample.annotation.df</span>,
  threads<span class="op">=</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="section level4">
<h4 id="parallelization">Parallelization<a class="anchor" aria-label="anchor" href="#parallelization"></a>
</h4>
<p>While setting the number of threads in the <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function will increase the speed of each individual alignment, the function will align each sample sequentially. To save time, you may want to perform alignment and feature counting on each file in a parallel computing environment and combine the samples to create an SCtkExperiment object. The <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function can be run on an individual file. Once individual sample objects have been created, combine them into a single SCtkExperiment object.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="creating-a-single-cell-object-from-aligned-bam-reads">Creating a Single Cell Object from aligned BAM reads<a class="anchor" aria-label="anchor" href="#creating-a-single-cell-object-from-aligned-bam-reads"></a>
</h2>
<p>If your data requires additional processing steps (UMI normalization, etc), you can use the <code><a href="../reference/alignSingleCellData.html">alignSingleCellData()</a></code> function to perform feature counting and create a single cell object without the alignment step if ‘.bam’ files are provided in the <code>inputfile1</code> parameter. Note that if your read data was sequenced using paired-end reads, set the <code>isPairedEnd</code> parameter <code>TRUE</code>.</p>
</div>
<div class="section level2">
<h2 id="manually-creating-a-single-cell-object-with-createsce">Manually Creating a Single Cell Object with createSCE()<a class="anchor" aria-label="anchor" href="#manually-creating-a-single-cell-object-with-createsce"></a>
</h2>
<p>If you choose to align and quantify your data using alternative tools, you can use the <code><a href="../reference/createSCE.html">createSCE()</a></code> function to create a single cell object that can be used in the single cell toolkit by providing a count data frame and optionally providing sample and feature annotations. See the <code><a href="../reference/createSCE.html">createSCE()</a></code> function help page for details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Jenkins, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, Emma Briars, Sebastian Carrasco Pro, W. Evan Johnson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
